---
title: "Exploratory Analysis Zillow"
output:
  html_document:
    fig_height: 4
    fig_width: 7
    theme: cosmo
---
# Avacados Tutorial

```{r, echo=FALSE, out.width="100%", fig.align="center"}
knitr::include_graphics("images/avacado.jpeg")  
```

For this tutorial, we'll pretend we work for a supermarket chain interested in avacado pricing. Understanding price changes and the drivers behind those changes can help us forecast future shifts that enable us to stay ahead of the market and create appropriate pricing given the economic environment. 

**Goals of this tutorial**
 - Introduce `ggplot2` in more detail
 - Install and Load Packages 
 - Load and interact with large dataset
 - Forecast future pricing and volume of product
 
**Datasets used**
- `avacado.csv`

## ggplot2 crash course

`ggplot2` is the most popular plotting package in R. It's regarded as one of the best visualization packages of any open-source programming language and has been refactored to work within other languages such as Python. The advantage of `ggplot2` is how optimized it is to work with big data. We can create `ggplots` for thousands of data points in less than a second. Customization options are also endless with `ggplot2`. `ggplot2` can create the following types of plots:

**1) Correlation**

* Scatterplot
* Scatterplot With Encircling
* Jitter Plot
* Counts Chart
* Bubble Plot
* Animated Bubble Plot
* Marginal Histogram / Boxplot
* Correlogram

**2) Deviation**

* Diverging Bars
* Diverging Lollipop Chart
* Diverging Dot Plot
* Area Chart

**3) Ranking**

* Ordered Bar Chart
* Lollipop Chart
* Dot Plot
* Slope Chart
* Dumbbell Plot

**4) Distribution**

* Histogram
* Density Plot
* Box Plot
* Dot + Box Plot
* Tufte Boxplot
* Violin Plot
* Population Pyramid

**5) Composition**

* Waffle Chart
* Pie Chart
* Treemap
* Bar Chart

**6) Change**

* Time Series Plots
  + From a Data Frame
  + Format to Monthly X Axis
  + Format to Yearly X Axis
  + From Long Data Format
  + From Wide Data Format
* Stacked Area Chart
* Calendar Heat Map
* Slope Chart
* Seasonal Plot

**7) Groups**

* Dendrogram
* Clusters

**8) Spatial**

* Open Street Map
* Google Road Map
* Google Hybrid Map

Additional information on these plots can be found at the following links:
* http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html
* https://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html
* https://ggplot2.tidyverse.org/

All `ggplot` instances follow the same basic format: first calling `ggplot` and then a plot type. `ggplot` takes two arguments: the first is a dataset (a data.frame object) and the second is a call to aes(), where you assign variables in the dataset to components of the graph called aesthetics. The specific type of plot you'd like to make with it is the `ggplot2` function for the general type of plot you want: for example, a barplot is called `geom_bar` as we saw in the last example. Let's quickly explore these:

```{r}
var1 = seq(from=1, to=30, by=1)
var2 = rnorm(n=30, mean = 10, sd = 1)
df <- data.frame(x = var1, y = var2)
head(df)
```

Now that we have a data frame with variables `var1` and `var2`, we can create a ggplot. Let's start by creating the background of our ggplot by using the first calling `ggplot`. 

```{r}
library(ggplot2)
ggplot(data = df, aes(x = var1, y = y))
```

The data argument is declared as our `df` data.frame. Our x axis and y axis are specified by the `var1` and `var2` variables within the `df` dataframe. R understands what `var1` and `var2` are because it assumes the aesthetics are *variables within* the `data` dataframe. Now we can plot a `ggplot2` instance using this.

```{r}
ggplot(df, aes(x = var1, y = var2)) + geom_point()
```

The `geom` in `geom_point` stands for geometry. All geometrical plots in `ggplot2` begin with `geom`. 

```{r}
ggplot(df, aes(x = var1, y = var2)) + geom_line()
```

Within the plot type we can specify additional arguments to enhance the plot in a way we'd like.

```{r}
ggplot(df, aes(x = var1, y = var2)) +
  geom_line(color = "darkblue", linetype = 2, size = 1)
```

We can also add linear regression lines to our plots easily

```{r}
ggplot(df, aes(x = var1, y = var2)) +
  geom_smooth(method = "lm")
```

We can have multiple geometry plots on one `ggplot` instance...

```{r}
ggplot(df, aes(x = var1, y = var2)) +
  geom_smooth() +
  geom_point()
```

Histograms can be done within 1 line.

```{r}
ggplot(df, aes(x = var2)) +
  geom_histogram()
```

Density plots are easy too!

```{r}
ggplot(df, aes(x = var2)) +
  geom_density()
```

Now that we've gone through some example plots with `ggplot2`, let's use `ggplot2` to plot some real data!


## Load the Avacados Dataset

First we'll load in the packages and the avacados dataset. 

```{r}
# first let's load in the packages we need
library(data.table)
library(dplyr)
library(ggplot2)
library(stringr)
library(DT)
library(tidyr)
library(corrplot)
library(leaflet)
library(lubridate)

# now let's load in our dataset using read.csv
avacado_df <- read.csv("datasets/avocado.csv")

```

```{r include=FALSE}
options(tibble.width = Inf)
```

Let's check out what the avacados dataframe (`avacado_df`) looks like.

```{r, echo=FALSE}
datatable(head(avacado_df,30), style="default", class="table-condensed", options = list(dom = 'tp',scrollX = TRUE))
```

* Is there null data ?
* What are various columns ?
* Drop any columns that are not necessary for now.
* Data in days/weeks ?. How many years ?
* How many regions and what are they ?
* How many unique type and what are they ?


There are 2 types of Avacados in this dataset - conventional and organic. How can we figure this out without seeing more of the dataset? Use the `unique` function which returns a list of each character string, number, or whatever is in a `vector` or `list`. 

```{r}
# understand what classes R recognizes our data as
class(avacado_df)
class(avacado_df$type)
# use the unique function to print out unique values within the 
unique(avacado_df['type'])

```
Now we're going to use `ggplot2` to plot a density plot of the avacados based on the type, 

```{r}
ggplot(avacado_df, aes(x=AveragePrice, fill=type)) + geom_density() 
```
